var activiteId="";var listeActivites={};var tblReponses={};if(sessionStorage.CL_reponses){tblReponses=jQuery.parseJSON(sessionStorage.CL_reponses)}function qcuCreation(a,e){var i=document.createElement("div");i.className="ctnQuestion";i.id="ctn_"+a+"_"+e;var b=document.createElement("p");b.className="txtQuestion";b.innerHTML=listeActivites[a][e].question;i.appendChild(b);var h=document.createElement("div");h.id="props_"+a+"_"+e;h.className="ctnProps";for(var d=0;d<listeActivites[a][e].props.length;d++){var c=document.createElement("button");c.innerHTML=listeActivites[a][e].props[d];c.id="rep_"+d;if(tblReponses[a+"_"+e]===d.toString()){c.className="qcu qcuCochet"}else{c.className="qcu"}if(tblReponses[a+"_"+e+"_V"]!==true){c.onclick=qcuClickHdlr;c.className+=" qcuActif"}h.appendChild(c)}i.appendChild(h);var g=document.createElement("div");g.id="ctnFidebaque_"+a+"_"+e;g.className="ctnFidebaque";g.innerHTML=listeActivites[a][e].fbGen;i.appendChild(g);document.getElementById("ctnQuestionsActi").appendChild(i);if(tblReponses[a+"_"+e+"_V"]===true){validerQcu(a,e,false)}else{var f=document.createElement("button");f.onclick=validerQcuHdlr;f.id="btnVal_"+a+"_"+e;f.className="btnValid";f.innerHTML="Valider";i.appendChild(f)}$(".qActivite").fadeIn("slow");document.getElementById("rep_0").focus()}function qcuClickHdlr(a){if($(a.currentTarget).hasClass("qcuActif")){if($(a.currentTarget).hasClass("qcuCochet")){$(a.currentTarget).removeClass("qcuCochet")}else{$("#"+a.currentTarget.parentElement.id+" button").removeClass("qcuCochet");$(a.currentTarget).addClass("qcuCochet")}tblReponses[a.currentTarget.parentElement.id.substr(6)]=a.currentTarget.id.split("_")[1]}}function validerQcuHdlr(a){var c=a.currentTarget.id.split("_")[1];var b=a.currentTarget.id.split("_")[2];validerQcu(c,b,true)}function validerQcu(f,b,e){var a=document.getElementById("ctn_"+f+"_"+b);if(tblReponses[f+"_"+b]===listeActivites[f][b].correction){a.className+=" reponseBonne"}else{a.className+=" reponseFausse"}$("#ctnFidebaque_"+f+"_"+b).slideDown("slow");$("#ctnFermer").show("fast");$("#btnVal_"+f+"_"+b).hide("fast");$("#props_"+f+"_"+b+" button").removeClass("qcuActif");tblReponses[f+"_"+b+"_V"]=true;sessionStorage.CL_reponses=JSON.stringify(tblReponses);if(f.indexOf("FIN")!==-1){var d=0;for(var c=0;c<7;c++){if(tblReponses[f+"_"+c+"_V"]){d++}}if(d===7){affichEvalPopup(e)}}}function qcmCreation(a,e){if(!tblReponses[a+"_"+e]){tblReponses[a+"_"+e]=["0","0","0","0","0","0","0"]}var i=document.createElement("div");i.className="ctnQuestion";i.id="ctn_"+a+"_"+e;var b=document.createElement("p");b.className="txtQuestion";b.innerHTML=listeActivites[a][e].question;i.appendChild(b);var h=document.createElement("div");h.id="props_"+a+"_"+e;h.className="ctnProps";for(var d=0;d<listeActivites[a][e].props.length;d++){var c=document.createElement("button");c.innerHTML=listeActivites[a][e].props[d];c.id="rep_"+d;if(tblReponses[a+"_"+e][d]==="1"){c.className="qcm qcmCochet"}else{c.className="qcm"}if(tblReponses[a+"_"+e+"_V"]!==true){c.onclick=qcmClickHdlr;c.className+=" qcmActif"}h.appendChild(c)}i.appendChild(h);var g=document.createElement("div");g.id="ctnFidebaque_"+a+"_"+e;g.className="ctnFidebaque";g.innerHTML=listeActivites[a][e].fbGen;i.appendChild(g);document.getElementById("ctnQuestionsActi").appendChild(i);if(tblReponses[a+"_"+e+"_V"]===true){validerQcm(a,e,false)}else{var f=document.createElement("button");f.onclick=validerQcmHdlr;f.id="btnVal_"+a+"_"+e;f.className="btnValid";f.innerHTML="Valider";i.appendChild(f)}$(".qActivite").fadeIn("slow");document.getElementById("rep_0").focus()}function qcmClickHdlr(a){if($(a.currentTarget).hasClass("qcmActif")){if($(a.currentTarget).hasClass("qcmCochet")){$(a.currentTarget).removeClass("qcmCochet");tblReponses[a.currentTarget.parentElement.id.substr(6)][parseInt(a.currentTarget.id.split("_")[1])]="0"}else{$(a.currentTarget).addClass("qcmCochet");tblReponses[a.currentTarget.parentElement.id.substr(6)][parseInt(a.currentTarget.id.split("_")[1])]="1"}}}function validerQcmHdlr(a){var c=a.currentTarget.id.split("_")[1];var b=a.currentTarget.id.split("_")[2];validerQcm(c,b,true)}function validerQcm(h,d,g){var a=document.getElementById("ctn_"+h+"_"+d);var b=true;for(var e=0;e<listeActivites[h][d].correction.length;e++){if(tblReponses[h+"_"+d][e]!==listeActivites[h][d].correction[e]){b=false}}if(b){a.className+=" reponseBonne"}else{a.className+=" reponseFausse"}$("#ctnFidebaque_"+h+"_"+d).slideDown("slow");$("#ctnFermer").show("fast");$("#btnVal_"+h+"_"+d).hide("fast");$("#props_"+h+"_"+d+" p").removeClass("qcmActif");tblReponses[h+"_"+d+"_V"]=true;sessionStorage.CL_reponses=JSON.stringify(tblReponses);if(h.indexOf("FIN")!==-1){var f=0;for(var c=0;c<7;c++){if(tblReponses[h+"_"+c+"_V"]){f++}}if(f===7){affichEvalPopup(g)}}}function validerPageQ(){var b=window.location.hash.substr(1).split("_")[1];for(var a=0;a<listeActivites[b].length;a++){validerQcu(a)}$("#btnValid").hide("fast");tblReponses[b+"_V"]=true;sessionStorage.CL_reponses=JSON.stringify(tblReponses);if(listeParcours[parcours.index].listeObjets[parcours.etape].type.indexOf("FIN")>-1){affichEvalPopup()}}function affichEval(){var d=0;var b=0;var a=listeParcours[parcours.index].listeObjets[parcours.etape].objId;for(var e=0;e<listeActivites[a].length;e++){b+=1;if(listeActivites[a][e].type==="qcu"){if(tblReponses[a+"_"+e]===listeActivites[a][e].correction){d+=1}}else{var h=1;for(var c=0;c<listeActivites[a][e].correction.length;c++){if(tblReponses[a+"_"+e][c]!==listeActivites[a][e].correction[c]){h=0}}d+=h}}var f=document.getElementById("ctnEval");var i="";if(d>1){i="s"}if(d>5){$("#ctnEval").html("Vous avez : "+d+" réponses correctes sur 7.<br>Bravo ! Vous savez (presque) tout sur les sciences du langage.");f.className="ctnEvalBon"}else{if(d>2){$("#ctnEval").html("Vous avez : "+d+" réponses correctes sur 7.<br>Pas mal, n'hésitez pas à revisionner certaines vidéos.");f.className="ctnEvalMoy"}else{$("#ctnEval").html("Vous avez : "+d+" réponse"+i+" correcte"+i+" sur 7.<br>Oups ! Je vous conseille de revisionner les vidéos.");f.className="ctnEvalNul"}}var g=document.getElementById("ctnPopinEval");g.innerHTML=$("#ctnEval").html();g.className=f.className;$("#ctnEval").show("slow")}function affichEvalPopup(a){affichEval();if(a){$(".ctnEvalPopin").show("slow")}};